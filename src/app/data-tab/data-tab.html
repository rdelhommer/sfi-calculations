<template class="data-tab">
  <h2>Data</h2>

  <form-wrap class="not-table">
    <form-section>
      <h3 slot="title">
        Profile
      </h3>

      <div class="form-section-row">
        <div>
          <form-group 
              orientation="horizontal" 
              model.bind="observer.name"
              on-changed.call="saveTab()">
            <div slot="label">
              Name
            </div>
          </form-group>
          <form-group 
              orientation="horizontal" 
              model.bind="observer.organization"
              on-changed.call="saveTab()">
            <div slot="label">
              Organization
            </div>
          </form-group>
          <form-group 
              orientation="horizontal" 
              model.bind="observer.address.lineOne"
              on-changed.call="saveTab()">
            <div slot="label">
              Address
            </div>
          </form-group>
          <form-group 
              orientation="horizontal" 
              model.bind="observer.address.lineTwo"
              on-changed.call="saveTab()">
            <div slot="label">
              
            </div>
          </form-group>
        </div>
        <div>
          
          <form-group 
              type="email"
              orientation="horizontal" 
              model.bind="observer.email"
              on-changed.call="saveTab()">
            <div slot="label">
              Email
            </div>
          </form-group>
          <form-group 
              type="phone"
              orientation="horizontal" 
              model.bind="observer.phone"
              on-changed.call="saveTab()">
            <div slot="label">
              Phone
            </div>
          </form-group>
        </div>
      </div>
    </form-section>
    <form-section>
      <h3 slot="title">
        Sample Information
      </h3>

      <div>
        <div class="form-section-row">
          <div>
            <form-group 
                orientation="horizontal" 
                model.bind="sample.name"
                on-changed.call="saveTab()">
              <div slot="label">
                Name
              </div>
            </form-group>
            <form-group 
                orientation="horizontal" 
                model.bind="sample.type"
                on-changed.call="saveTab()">
              <div slot="label">
                Type
              </div>
            </form-group>
            <form-group 
                orientation="horizontal" 
                model.bind="sample.plant"
                on-changed.call="saveTab()">
              <div slot="label">
                Plant Present/Desired
              </div>
            </form-group>
            <form-group-select 
                from-enum.bind="Succession"
                orientation="horizontal"
                model.bind="sample.succession"
                placeholder="Please Select"
                on-changed.call="saveTab()">
              <div slot="label">
                Plant Succession
              </div>
            </form-group-select>
          </div>
          <div>
            <form-group 
                orientation="horizontal" 
                model.bind="sample.dateCollected"
                on-changed.call="saveTab()">
              <div slot="label">
                Date Collected
              </div>
            </form-group>
            <form-group 
                orientation="horizontal" 
                model.bind="sample.dateObserved"
                on-changed.call="saveTab()">
              <div slot="label">
                Date Observed
              </div>
            </form-group>
            <form-group 
                orientation="horizontal" 
                model.bind="sample.observedBy"
                on-changed.call="saveTab()">
              <div slot="label">
                Observed by
              </div>
            </form-group>						
          </div>
        </div>
      </div>
      <div>
        <form-group-textarea
            orientation="horizontal" 
            model.bind="sample.notes"
            on-changed.call="saveTab()"
            rows.bind="5">
          <div slot="label">
            Notes
          </div>
        </form-group-textarea>
      </div>
      <div>
        <div class="form-section-row">
          <div>
            <form-group 
                orientation="horizontal" 
                model.bind="sample.mainDilution"
                on-changed.call="saveTab()">
              <div slot="label">
                Main Dilution
              </div>
            </form-group>	
            <form-group 
                orientation="horizontal" 
                model.bind="sample.bacteriaDilution"
                on-changed.call="saveTab()">
              <div slot="label">
                Bacteria Dilution
              </div>
            </form-group>	
            <form-group 
                orientation="horizontal" 
                model.bind="sample.fieldsPerReading"
                on-changed.call="saveTab()">
              <div slot="label">
                Fields per Reading
              </div>
            </form-group>	
          </div>
          <div>
            <form-group 
                orientation="horizontal" 
                model.bind="sample.dropsPerSample"
                on-changed.call="saveTab()">
              <div slot="label">
                Drops per Sample
              </div>
            </form-group>	
            <form-group 
                orientation="horizontal" 
                model.bind="sample.dropsPerMl"
                on-changed.call="saveTab()">
              <div slot="label">
                Drops per ml
              </div>
            </form-group>	
            <form-group 
                orientation="horizontal" 
                model.bind="sample.coverslipSize"
                on-changed.call="saveTab()">
              <div slot="label">
                Coverslip Size
              </div>
            </form-group>	
            <form-group 
                orientation="horizontal" 
                model.bind="sample.eyepieceFieldSize"
                on-changed.call="saveTab()">
              <div slot="label">
                Eyepiece Field Size
              </div>
            </form-group>	
          </div>
        </div>
      </div>
    </form-section>
  </form-wrap>
  <div if.bind="canViewData" class="data-tab__table-container">
    <table class="data-tab__fixed-columns" css="left:${headerLeft}px">
      <tr><th>&nbsp;</th></tr>
      <tbody class="fixed-columns">
        <tr class="data-tab__row--green">
          <th>Total # Per Slide</th>
        </tr>
        <tr>
          <th>Nematodes</th>
        </tr>
        <tr repeat.for="calc of nematodeCalcs">
          <th>${calc.organismName}</th>
        </tr>
        <tr><th>&nbsp;</th></tr>
        <tr>
          <th>Readings #</th>
        </tr>
        <tbody repeat.for="calc of organismCalcs">
          <tr class="data-tab__row--green">
            <th>&nbsp;</th>
          </tr>
          <tr>
            <th>${calc.organismName}</th>
          </tr>
          <tr if.one-time="!calc.isField">
            <th>Diameter</th>
          </tr>
          <tr if.one-time="!calc.isField">
            <th>Color</th>
          </tr>
          <tr if.one-time="calc.hasExpanded">
            <th>Readings Expanded -></th>
          </tr>
          <tr if.one-time="!calc.isField" class="data-tab__row--gray">
            <th>Do not use this row --></th>
          </tr>
        </tbody>
        <tr>
          <th>&nbsp;</th>
        </tr>
        <tr class="data-tab__row--green">
          <th>Readings #</th>
        </tr>
        <tr>
          <th>Bacteria</th>
        </tr>
        <tr>
          <th>Aerobic Bacteria</th>
        </tr>
        <tr>
          <th>Anaerobic Bacteria</th>
        </tr>
        <tr>
          <th>Pathogenic Bacteria</th>
        </tr>
        <tr class="data-tab__row--green">
          <th>&nbsp;</th>
        </tr>
        <tr>
          <th>F:B Ratio</th>
        </tr>
      </tbody>
    </table>
    <table>
      <thead>
        <tr>
          <th colspan="14"></th>
          <th class="data-tab__td--mean">Mean</th>
          <th class="data-tab__td--stdev">StDev</th>
          <th class="data-tab__td--dilution">Dilution</th>
          <th></th>
          <th class="data-tab__td--mean">Mean Results</th>
          <th></th>
          <th class="data-tab__td--stdev">Standard Deviation Results</th>
        </tr>
      </thead>
      <tbody>
        <tr class="data-tab__row--green">
          <th>Total # Per Slide</th>
          <td colspan="17"></td>
          <td><strong>Nematode numbers/g or ml</td></strong>
          <td colspan="2"></td>
        </tr>
        <tr>
          <th>Nematodes</th>
          <td colspan="13" class="data-tab__td--left data-tab__td--gray">Do not use this row --></td>
          <td class="data-tab__td--mean"></td>
          <td class="data-tab__td--stdev"></td>
          <td class="data-tab__td--dilution"></td>
          <td class="data-tab__td--standard"></td>
          <td class="data-tab__td--mean"></td>
          <td class="data-tab__td--standard"></td>
          <td class="data-tab__td--stdev"></td>
        </tr>
        <tr repeat.for="calc of nematodeCalcs">
          <th>${calc.organismName}</th>
          <td class="data-tab__td--border">
            <input 
                value.bind="calc.lengths[0]"
                type="number"
                change.delegate="updateCalc(calc)"
                min="0"/>
          </td>
          <td colspan="12"></td>
          <td class="data-tab__td--mean">${calc.lengthMeanMm}</td>
          <td class="data-tab__td--stdev"><!-- This one is empty since it's a single reading --></td>
          <td class="data-tab__td--dilution">
            <input 
                value.bind="calc.dilution"
                type="number"
                change.delegate="updateCalc(calc)"
                min="0"/>
          </td>
          <td></td>
          <td class="data-tab__td--mean">${calc.meanResult | toFixed:1}</td>
          <td></td>
          <td class="data-tab__td--stdev"></td>
        </tr>
        <tr>
          <th></th>
          <td colspan="13"></td> 
          <td class="data-tab__td--mean"></td>
          <td class="data-tab__td--stdev"></td>
          <td class="data-tab__td--dilution"></td>
          <td></td>
          <td class="data-tab__td--mean"></td>
          <td></td>
          <td class="data-tab__td--stdev"></td>
        </tr>
      </tbody>
      <tr>
        <th>Readings #</th>
        <td repeat.for="reading of readings"
            class="data-tab__td--border-top data-tab__td--border-left data-tab__td--border-right">
          ${$index + 1}
        </td>
        <td colspan="8"></td> 
        <td class="data-tab__td--mean"></td>
        <td class="data-tab__td--stdev"></td>
        <td class="data-tab__td--dilution"></td>
        <td></td>
        <td class="data-tab__td--mean"></td>
        <td></td>
        <td class="data-tab__td--stdev"></td>
      </tr>
      <tbody repeat.for="calc of organismCalcs">
        <tr class="data-tab__row--green">
          <th>&nbsp;</th>
          <td 
              repeat.for="i of calc.lengths.length" 
              class="data-tab__td--border-left data-tab__td--border-right">
          </td>
          <td colspan="11"></td>
          <td><strong if.bind="!calc.isCounting">Length in cm of ${calc.organismName}/g</strong></td>
          <td><strong>Micrograms of ${calc.organismName}/g or ml</strong></td>
          <td><strong if.bind="!calc.isCounting">Length in cm of ${calc.organismName}/g</strong></td>
          <td><strong>Micrograms of ${calc.organismName}/g or ml</strong></td>
        </tr>
        <tr>
          <th>${calc.organismName}</th>
          <td repeat.for="reading of calc.lengths"
              class="data-tab__td--border-left data-tab__td--border-right">
            <input 
                value.bind="calc.lengths[$index]"
                change.delegate="updateCalc(calc)"
                type="number"
                step=".01" 
                min="0"
                disabled.bind="!canEditData"/>
          </td>
          <td colspan="8"></td>
          <td class="data-tab__td--mean">${calc.lengthMeanMm | toFixed:2}</td>
          <td class="data-tab__td--stdev">${calc.lengthStDevMm | toFixed:2}</td>
          <td class="data-tab__td--dilution">
            <input 
                value.bind="calc.dilution"
                type="number"
                change.delegate="updateCalc(calc)"
                min="0"/>
          </td>
          <td><span if.bind="!calc.isCounting">${calc.lengthMeanCmPerG | toFixed:0}</span></td>
          <td class="data-tab__td--mean">${calc.meanResult | toFixed:2}</td>
          <td></td>
          <td class="data-tab__td--stdev">${calc.stDevResult | toFixed:2}</td>
        </tr>
        <tr if.one-time="!calc.isField">
          <th>Diameter</th>
          <td repeat.for="reading of calc.diameters"
              class="data-tab__td--border-left data-tab__td--border-right">
            <input 
                value.bind="reading"
                change.delegate="updateCalc(calc)"
                type="number"
                step=".01"
                min="0" 
                disabled.bind="!canEditData"/>
          </td>
          <td colspan="8"></td>
          <td class="data-tab__td--mean"></td>
          <td class="data-tab__td--stdev"></td>
          <td class="data-tab__td--dilution"></td>
          <td></td>
          <td class="data-tab__td--mean"></td>
          <td></td>
          <td class="data-tab__td--stdev"></td>
        </tr>
        <tr if.one-time="!calc.isField">
          <th>Color</th>
          <td repeat.for="reading of calc.lengths"
              class="data-tab__td--border-left data-tab__td--border-right">
            <form-group-select 
                if.bind="calc.organismName === 'Fungi'"
                from-enum.bind="FungalColor"
                orientation="horizontal"
                placeholder="Please Select">
            </form-group-select>
            <form-group-select 
                if.bind="calc.organismName !== 'Fungi'"
                from-enum.bind="OomyceteColor"
                orientation="horizontal"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td colspan="8"></td>
          <td class="data-tab__td--mean"></td>
          <td class="data-tab__td--stdev"></td>
          <td class="data-tab__td--dilution"></td>
          <td><strong>Average Diameter in cm</strong></td>
          <td class="data-tab__td--mean"><strong>Average Diameter in um</strong></td>
          <td></td>
          <td class="data-tab__td--stdev"></td>
        </tr>
        <tr if.one-time="calc.hasExpanded">
          <th>Readings Expanded -></th>
          <td repeat.for="i of calc.lengths.length"
              class="data-tab__td--border-left data-tab__td--border-right">
          </td>
          <td colspan="7"></td>
          <td><strong>Length in cm</strong></td>
          <td class="data-tab__td--mean">${calc.lengthMeanCm | toFixed:2}</td>
          <td class="data-tab__td--stdev">${calc.lengthStDevCm | toFixed:2}</td>
          <td class="data-tab__td--dilution"></td>
          <td if.bind="!calc.isField">${calc.averageDiameterCm | toFixed:5}</td>
          <td if.bind="!calc.isField" class="data-tab__td--mean">${calc.averageDiameterUm | toFixed:1}</td>
          <td if.bind="calc.isField"></td>
          <td if.bind="calc.isField" class="data-tab__td--mean"></td>
          <td></td>
          <td class="data-tab__td--stdev"></td>
        </tr>
        <tr if.one-time="!calc.isField" class="data-tab__row--gray">
          <th>Do not use this row --></th>
          <td repeat.for="reading of calc.diameters"
              class="data-tab__td--border-left data-tab__td--border-right">
            ${(calc.lengths[$index] * reading) | toFixed:2}
          </td>
          <td colspan="8"></td>
          <td class="data-tab__td--mean"></td>
          <td class="data-tab__td--stdev"></td>
          <td class="data-tab__td--dilution"></td>
          <td class="data-tab__td--standard"></td>
          <td class="data-tab__td--mean"></td>
          <td class="data-tab__td--standard"></td>
          <td class="data-tab__td--stdev"></td>
        </tr>
      </tbody>
      <tbody>
        <tr>
          <th></th>
          <td colspan="5" class="data-tab__td--left data-tab__td--border-top">
            <strong>Bacteria: How much of the each field did you count?</strong>
          </td>
          <td colspan="2"></td>
          <td colspan="3">
            <form-group-select 
                from-enum.bind="FieldPercentage"
                orientation="horizontal"
                model.bind="bacteriaObs.fieldPercentage"
                placeholder="Please Select"
                on-changed.call="updateBacteriaObsCalc()"
                >
            </form-group-select>
          </td>
          <td colspan="3"></td>
          <td class="data-tab__td--mean"></td>
          <td class="data-tab__td--stdev"></td>
          <td class="data-tab__td--dilution"></td>
          <td></td>
          <td class="data-tab__td--mean"></td>
          <td></td>
          <td class="data-tab__td--stdev"></td>
        </tr>
        <tr class="data-tab__row--green">
          <th>Readings #</th>
          <td repeat.for="i of bacteriaObs.readings.length"
              class="data-tab__td--border-top data-tab__td--border-left data-tab__td--border-right">${i + 1}</td>
          <td colspan="2"></td>
          <td repeat.for="i of bacteriaObs.results.length"
              class="data-tab__td--border-top data-tab__td--border-left data-tab__td--border-right">${i + 1}</td>
          <td colspan="4"></td>
          <td><strong>Number of Bacteria/g</strong></td>
          <td><strong>Micrograms of Bacteria/g or ml</strong></td>
          <td><strong>Number of Bacteria/g</strong></td>
          <td><strong>Micrograms of Bacteria/g or ml</strong></td>
        </tr>
        <tr>
          <th>Bacteria</th>
          <td repeat.for="reading of bacteriaObs.readings"
              class="data-tab__td--border-bottom data-tab__td--border-left data-tab__td--border-right">
            <input 
                change.delegate="updateBacteriaObsCalc()"
                value.bind="bacteriaObs.readings[$index]"
                type="number"
                min="0" />
          </td>
          <td></td>
          <td class="data-tab__td--right">Results:</td>
          <td repeat.for="result of bacteriaObs.results"
              class="data-tab__td--border-bottom data-tab__td--border-left data-tab__td--border-right">
            ${result}
          </td>
          <td></td>
          <td class="data-tab__td--mean">${bacteriaObs.mean | toFixed:2}</td>
          <td class="data-tab__td--stdev">${bacteriaObs.stDev | toFixed:2}</td>
          <td class="data-tab__td--dilution">${sample.bacteriaDilution}</td>
          <td>${bacteriaObs.meanNumBacteriaPerG | toFixed:0}</td>
          <td class="data-tab__td--mean">${bacteriaObs.meanResult | toFixed:0}</td>
          <td>${bacteriaObs.stDevNumBacteriaPerG | toFixed:0}</td>
          <td class="data-tab__td--stdev">${bacteriaObs.stDevResult | toFixed:0}</td>
        </tr>
        <tr>
          <th>Aerobic Bacteria</th>
          <td>
            <form-group-select 
                from-enum.bind="YesNo"
                orientation="horizontal"
                model.bind="bacteriaObs.aerobicBacteriaObserved"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td colspan="6" class="data-tab__td--right">
            If yes, bacterial shapes observed:
          </td>
          <td colspan="2">
            <form-group-select 
                from-enum.bind="AerobicBacteria"
                orientation="horizontal"
                model.bind="bacteriaObs.aerobicBacteria[0]"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td colspan="2">
            <form-group-select 
                from-enum.bind="AerobicBacteria"
                orientation="horizontal"
                model.bind="bacteriaObs.aerobicBacteria[1]"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td colspan="2">
            <form-group-select 
                from-enum.bind="AerobicBacteria"
                orientation="horizontal"
                model.bind="bacteriaObs.aerobicBacteria[2]"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td colspan="4"></td>
          <td class="data-tab__td--mean"></td>
          <td></td>
          <td class="data-tab__td--stdev"></td>
        </tr>
        <tr>
          <th>Anaerobic Bacteria</th>
          <td>
            <form-group-select 
                from-enum.bind="YesNo"
                orientation="horizontal"
                model.bind="bacteriaObs.anaerobicBacteriaObserved"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td colspan="6" class="data-tab__td--right">
            If yes, bacterial shapes observed:
          </td>
          <td colspan="2">
            <form-group-select 
                from-enum.bind="AnaerobicBacteria"
                orientation="horizontal"
                model.bind="bacteriaObs.anaerobicBacteria[0]"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td colspan="2">
            <form-group-select 
                from-enum.bind="AnaerobicBacteria"
                orientation="horizontal"
                model.bind="bacteriaObs.anaerobicBacteria[1]"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td colspan="6"></td>
          <td class="data-tab__td--mean"></td>
          <td></td>
          <td class="data-tab__td--stdev"></td>
        </tr>
        <tr>
          <th>Pathogenic Bacteria</th>
          <td>
            <form-group-select 
                from-enum.bind="YesNo"
                orientation="horizontal"
                model.bind="bacteriaObs.pathogenicBacteriaObserved"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td colspan="6" class="data-tab__td--right">
            If yes, bacterial shapes observed:
          </td>
          <td colspan="2">
            <form-group-select 
                from-enum.bind="PathogenicBacteria"
                orientation="horizontal"
                model.bind="bacteriaObs.pathogenicBacteria[0]"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td colspan="2">
            <form-group-select 
                from-enum.bind="PathogenicBacteria"
                orientation="horizontal"
                model.bind="bacteriaObs.pathogenicBacteria[1]"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td colspan="2">
            <form-group-select 
                from-enum.bind="PathogenicBacteria"
                orientation="horizontal"
                model.bind="bacteriaObs.pathogenicBacteria[2]"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td colspan="4"></td>
          <td class="data-tab__td--mean"></td>
          <td></td>
          <td class="data-tab__td--stdev"></td>
        </tr>
        <tr class="data-tab__row--green">
          <th>&nbsp;</th>
          <td colspan="20"></td>
        </tr>
        <tr>
          <th>F:B Ratio</th>
          <td colspan="17" class="data-tab__td--left data-tab__td--gray">
            Do not use this row -->
          </td>
          <td class="data-tab__td--mean">
            ${fbRatio | toFixed:2}
          </td>
          <td colspan="2" class="data-tab__td--standard"></td>
        </tr>
      </tbody>

    </table>
  </div>
</template>