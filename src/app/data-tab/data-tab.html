<template>
  <h2>Data</h2>

  <form-wrap>
    <form-section>
      <h3 slot="title">
        Profile
      </h3>

        <form-group 
            orientation="horizontal" 
            model.bind="observer.name"
            on-changed.call="saveTab()">
          <div slot="label">
            Name
          </div>
        </form-group>
        <form-group 
            orientation="horizontal" 
            model.bind="observer.organization"
            on-changed.call="saveTab()">
          <div slot="label">
            Organization
          </div>
        </form-group>
        <form-group 
            orientation="horizontal" 
            model.bind="observer.address.lineOne"
            on-changed.call="saveTab()">
          <div slot="label">
            Address
          </div>
        </form-group>
        <form-group 
            orientation="horizontal" 
            model.bind="observer.address.lineTwo"
            on-changed.call="saveTab()">
          <div slot="label">
            
          </div>
        </form-group>
        <form-group 
            type="email"
            orientation="horizontal" 
            model.bind="observer.email"
            on-changed.call="saveTab()">
          <div slot="label">
            Email
          </div>
        </form-group>
        <form-group 
            type="phone"
            orientation="horizontal" 
            model.bind="observer.phone"
            on-changed.call="saveTab()">
          <div slot="label">
            Phone
          </div>
        </form-group>
    </form-section>
    <form-section>
      <h3 slot="title">
        Sample Information
      </h3>
      <form-group 
          orientation="horizontal" 
          model.bind="sample.name"
          on-changed.call="saveTab()">
        <div slot="label">
          Name
        </div>
      </form-group>
      <form-group 
          orientation="horizontal" 
          model.bind="sample.type"
          on-changed.call="saveTab()">
        <div slot="label">
          Type
        </div>
      </form-group>
      <form-group 
          orientation="horizontal" 
          model.bind="sample.plant"
          on-changed.call="saveTab()">
        <div slot="label">
          Plant Present/Desired
        </div>
      </form-group>
      <form-group-select 
          from-enum.bind="Succession"
          orientation="horizontal"
          model.bind="sample.succession"
          placeholder="Please Select"
          on-changed.call="saveTab()">
        <div slot="label">
          Plant Succession
        </div>
      </form-group-select>
      <form-group 
          orientation="horizontal" 
          model.bind="sample.dateCollected"
          on-changed.call="saveTab()">
        <div slot="label">
          Date Collected
        </div>
      </form-group>
      <form-group 
          orientation="horizontal" 
          model.bind="sample.dateObserved"
          on-changed.call="saveTab()">
        <div slot="label">
          Date Observed
        </div>
      </form-group>
      <form-group 
          orientation="horizontal" 
          model.bind="sample.observedBy"
          on-changed.call="saveTab()">
        <div slot="label">
          Observed by
        </div>
      </form-group>						
      <form-group-textarea
          orientation="horizontal" 
          model.bind="sample.notes"
          on-changed.call="saveTab()">
        <div slot="label">
          Notes
        </div>
      </form-group-textarea>
      <form-group 
          orientation="horizontal" 
          model.bind="sample.mainDilution"
          on-changed.call="saveTab()">
        <div slot="label">
          Main Dilution
        </div>
      </form-group>	
      <form-group 
          orientation="horizontal" 
          model.bind="sample.bacteriaDilution"
          on-changed.call="saveTab()">
        <div slot="label">
          Bacteria Dilution
        </div>
      </form-group>	
      <form-group 
          orientation="horizontal" 
          model.bind="sample.fieldsPerReading"
          on-changed.call="saveTab()">
        <div slot="label">
          Fields per Reading
        </div>
      </form-group>	
      <form-group 
          orientation="horizontal" 
          model.bind="sample.dropsPerSample"
          on-changed.call="saveTab()">
        <div slot="label">
          Drops per Sample
        </div>
      </form-group>	
      <form-group 
          orientation="horizontal" 
          model.bind="sample.dropsPerMl"
          on-changed.call="saveTab()">
        <div slot="label">
          Drops per ml
        </div>
      </form-group>	
      <form-group 
          orientation="horizontal" 
          model.bind="sample.coverslipSize"
          on-changed.call="saveTab()">
        <div slot="label">
          Coverslip Size
        </div>
      </form-group>	
      <form-group 
          orientation="horizontal" 
          model.bind="sample.eyepieceFieldSize"
          on-changed.call="saveTab()">
        <div slot="label">
          Eyepiece Field Size
        </div>
      </form-group>	
    </form-section>
  </form-wrap>
  <div> <!--if.bind="canViewData">-->
    <table>
      <thead>
        <tr>
          <th colspan="7"></th>
          <th>Mean</th>
          <th>StDev</th>
          <th>Dilution</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>Total # Per Slide</th>
          <td colspan="9"></td>
        </tr>
        <tr>
          <th>Nematodes</th>
          <td colspan="6">Do not use this row --></td>
        </tr>
        <tr repeat.for="calc of nematodeCalcs">
          <th>${calc.header}</th>
          <td>
            <input 
                value.bind="calc.mean"
                type="number"/>
          </td>
          <td colspan="5"></td>
          <td>${calc.mean == null ? '--' : calc.mean}</td>
          <td><!-- This one is empty since it's a single reading --></td>
          <td>
            ${sample.mainDilution}</td>
        </tr>
        <tr>
          <th></th>
          <td colspan="6"></td> 
        </tr>
      </tbody>
      <tr>
        <th>Readings #</th>
        <td repeat.for="reading of readings">${$index + 1}</td>
      </tr>
      <tr>
        <th></th>
        <td colspan="9"></td>
      </tr>
      <tbody repeat.for="calc of organismCalcs">
        <tr>
          <th>${calc.header}</th>
          <td repeat.for="reading of organismReadings[calc.header]">
            <input 
                value.bind="reading.totalLength"
                change.delegate="updateReadingCalc(calc)"
                type="number"
                step=".01" />
          </td>
          <td></td>
          <td>${calc.lengthMean == null ? '--' : calc.lengthMean | toFixed:2}</td>
          <td>${calc.lengthStDev == null ? '--' : calc.lengthStDev | toFixed:2}</td>
          <td>${sample.mainDilution}</td>
      </tr>
        <tr if.one-time="!calc.isField">
          <th>Diameter</th>
          <td repeat.for="reading of organismReadings[calc.header]">
            <input 
                value.bind="reading.averageDiameter"
                change.delegate="updateReadingCalc(calc)"
                type="number"
                step=".01" />
          </td>
          <td></td>
          <td>${calc.diameterMean == null ? '--' : calc.diameterMean | toFixed:2}</td>
          <td>${calc.diameterStDev == null ? '--' : calc.diameterStDev | toFixed:2}</td>
          <td></td>
        </tr>
        <tr if.one-time="!calc.isField">
          <th>Color</th>
          <td repeat.for="reading of organismReadings[calc.header]">
            <form-group-select 
                if.bind="calc.header === 'Fungi'"
                from-enum.bind="FungalColor"
                orientation="horizontal"
                placeholder="Please Select">
            </form-group-select>
            <form-group-select 
                if.bind="calc.header !== 'Fungi'"
                from-enum.bind="OomyceteColor"
                orientation="horizontal"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
        <tr if.one-time="calc.hasExpanded">
          <th>Readings Expanded -></th>
          <td repeat.for="reading of organismReadings[calc.header]"></td>
          <td>Length in cm</td>
          <td>${calc.lengthMean == null ?  '--' : calc.lengthMean * FOV_DIAMETER_MM / 10 | toFixed:2}</td>
          <td>${calc.lengthStDev == null ? '--' : calc.lengthStDev * FOV_DIAMETER_MM / 10 | toFixed:2}</td>
          <td></td>
        </tr>
        <tr if.one-time="!calc.isField">
          <th>Do not use this row --></th>
          <td repeat.for="reading of organismReadings[calc.header]">
            ${(reading.totalLength * reading.averageDiameter) | toFixed:2}
          </td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
      </tbody>
      <tbody>
        <tr>
          <th></th>
          <td colspan="7">
            Bacteria: How much of the each field did you count?
          </td>
          <td colspan="3">
            <form-group-select 
                from-enum.bind="FieldPercentage"
                orientation="horizontal"
                model.bind="bacteriaObs.fieldPercentage"
                placeholder="Please Select"
                on-changed.call="updateBacteriaObsCalc()"
                >
            </form-group-select>
          </td>
        </tr>
        <tr>
          <th>Readings #</th>
          <td repeat.for="i of bacteriaObs.readings.length">${i + 1}</td>
          <td colspan="2"></td>
          <td repeat.for="i of bacteriaObs.results.length">${i + 1}</td>
        </tr>
        <tr>
          <th>Bacteria</th>
          <td repeat.for="reading of bacteriaObs.readings">
            <input 
                change.delegate="updateBacteriaObsCalc()"
                value.bind="bacteriaObs.readings[$index]"
                type="number" />
          </td>
          <td colspan="2"></td>
          <td repeat.for="result of bacteriaObs.results">
            ${ result == null ? '--' : result }
          </td>
        </tr>
        <tr>
          <th>Aerobic Bacteria</th>
          <td>
            <form-group-select 
                from-enum.bind="YesNo"
                orientation="horizontal"
                model.bind="bacteriaObs.aerobicBacteriaObserved"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td colspan="6">
            If yes, bacterial shapes observed:
          </td>
          <td>
            <form-group-select 
                from-enum.bind="AerobicBacteria"
                orientation="horizontal"
                model.bind="bacteriaObs.aerobicBacteria[0]"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td>
            <form-group-select 
                from-enum.bind="AerobicBacteria"
                orientation="horizontal"
                model.bind="bacteriaObs.aerobicBacteria[1]"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td>
            <form-group-select 
                from-enum.bind="AerobicBacteria"
                orientation="horizontal"
                model.bind="bacteriaObs.aerobicBacteria[2]"
                placeholder="Please Select">
            </form-group-select>
          </td>
        </tr>
        <tr>
          <th>Anaerobic Bacteria</th>
          <td>
            <form-group-select 
                from-enum.bind="YesNo"
                orientation="horizontal"
                model.bind="bacteriaObs.anaerobicBacteriaObserved"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td colspan="6">
            If yes, bacterial shapes observed:
          </td>
          <td>
            <form-group-select 
                from-enum.bind="AnaerobicBacteria"
                orientation="horizontal"
                model.bind="bacteriaObs.anaerobicBacteria[0]"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td>
            <form-group-select 
                from-enum.bind="AnaerobicBacteria"
                orientation="horizontal"
                model.bind="bacteriaObs.anaerobicBacteria[1]"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td></td>
        </tr>
        <tr>
          <th>Pathogenic Bacteria</th>
          <td>
            <form-group-select 
                from-enum.bind="YesNo"
                orientation="horizontal"
                model.bind="bacteriaObs.pathogenicBacteriaObserved"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td colspan="6">
            If yes, bacterial shapes observed:
          </td>
          <td>
            <form-group-select 
                from-enum.bind="PathogenicBacteria"
                orientation="horizontal"
                model.bind="bacteriaObs.pathogenicBacteria[0]"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td>
            <form-group-select 
                from-enum.bind="PathogenicBacteria"
                orientation="horizontal"
                model.bind="bacteriaObs.pathogenicBacteria[1]"
                placeholder="Please Select">
            </form-group-select>
          </td>
          <td>
            <form-group-select 
                from-enum.bind="PathogenicBacteria"
                orientation="horizontal"
                model.bind="bacteriaObs.pathogenicBacteria[2]"
                placeholder="Please Select">
            </form-group-select>
          </td>
        </tr>
      </tbody>

    </table>
  </div>
</template>